---
title: 有关电子邮件的三个协议--smtp/pop/imap
tags: [network, protocol]
category: 微小贡献
---

这篇博客主要介绍与电子邮件有关的三个协议，偏重原理，力求简洁。
<!--more-->

简单来说SMTP是发件方邮件客户端(比如ThunderBird, 网易邮箱大师)与发件服务器之间通信的协议，而POP或IMAP是收件方邮件客户端从收件服务器读取邮件的协议。这三个协议的全称如下：
* SMTP: Simple Mail Transfer Protocol
* POP: Post Office Protocol
* IMAP: Internet Mail Access Protocol

{% asset_img 有关电子邮件的三个协议-smtp-pop-imap/mail.png %}
上面的这张图展示了一位qq邮箱用户向gmail邮箱用户发件的过程。

为什么电子邮件没有采用最简单粗暴的点对点通信？也就是说，去掉收件服务器和发件服务器有什么问题？

## POP/IMAP服务器的功能及两个协议的区别
### 功能
邮件的用户并不是总是在线的，但是他们希望离线的时候也有一个地方为他们代收邮件，然后在他们上线的时候将邮件交给他们的客户端。这就是POP或者IMAP服务器所做的事情。如果没有收件服务器，所有在接收方离线期间发生的邮件投递都会失败。
### 区别
POP协议和IMAP协议的主要区别是：客户端与服务器的交互性。
使用POP协议时：
1. 收件服务器只负责转投邮件而不提供从客户端管理服务器上的文件。也就是说，一旦客户端从收件服务器上取回邮件，对邮件所做的删除、标注等动作都只在本地有效，而不能同步到服务器上。
2. 在默认情况下，如果你通过客户端A从服务器上将一封邮件取回本地，那么服务器上不会保存该邮件副本，这时你在另一个邮件客户端B上就无法下载该邮件了（这点可以通过设置在"服务器上保留副本"解决）。

因为上述两点原因，可以说POP协议对多客户端的支持并不友好。但是使用IMAP协议时，你的客户端相当于变成了服务器的远程控制终端，客户端中的内容以及你在客户端中做出的动作会同步反应到服务器上，因此客户端与服务器的交互性更好，对多客户端的支持也更好。

{% asset_img 有关电子邮件的三个协议-smtp-pop-imap/popvsimap.gif %}
(*上图来自博客[POP3、SMTP和IMAP之间的区别和联系](https://blog.csdn.net/qq877507054/article/details/71249272)*)

## 为什么需要SMTP服务器
SMTP的主要功能有两个：1.为发送方用户提供暂存与自动转发服务；2.提供认证服务，防止发件域名被垃圾邮件制造者滥用

我们先回顾一下现实世界中收发实体邮件的过程：企鹅村的麻花想寄一封信给猪妹村的佩奇, 于是

1. 麻花带着写好的信送到了企鹅村邮局，在143号窗口，也就是寄件专用窗口，按照《因特国邮件寄件规范》向工作人员出示了身份证件，然后将信件交给了邮局工作人员
2. 几天后邮政专车将信送到了猪妹村邮局
3. 猪妹村邮局通知佩奇有他的来信，然后佩奇来到猪妹村邮局25号窗口，也就是收件专用窗口，先按照《因特国邮件收件规范》向工作人员展示了身份证件，然后取走了信

就这样，一次邮件通信完成了。
电子邮件的收发过程与之类似。上述例子对应到网络世界中：
* 

